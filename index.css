/* --- RESET & BODY --- */
* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

body {
  width: 100vw; 
  height: 100vh;
  display: flex; 
  justify-content: center; 
  align-items: flex-end; 
  font-family: 'Engagement', cursive; 
  overflow: hidden;
  background-color: #000; 
  padding-bottom: 50px; 
}

/* --- BACKGROUND & EFFECTS --- */
#bg-video { 
  position: fixed; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%; 
  z-index: -1; 
  object-fit: cover; 
}

.vignette { 
  position: fixed; 
  bottom: 0; 
  left: 0; 
  width: 100%; 
  height: 40%; 
  background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); 
  z-index: 0; 
  pointer-events: none; 
}

#petals-container { 
  position: fixed; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%; 
  pointer-events: none; 
  z-index: 5; 
}

.petal { 
  position: absolute; 
  background-color: #ff4d6d; 
  border-radius: 150% 0 150% 0; 
  opacity: 0.7; 
  animation: fall linear infinite; 
}

@keyframes fall { 
  0% { transform: translateY(-10vh) rotate(0deg); } 
  100% { transform: translateY(110vh) rotate(360deg); } 
}

/* --- POLAROID --- */
.polaroid {
  position: absolute; 
  left: 50%; 
  top: 50%; 
  width: 160px; 
  height: 200px;
  background-color: white; 
  padding: 10px 10px 25px 10px; 
  box-shadow: 0 4px 15px rgba(0,0,0,0.4);
  transform: translate(-50%, -50%) rotate(0deg); 
  z-index: 1.5; 
  opacity: 0;
  transition: all 0.8s ease-in-out; 
  transition-delay: 0.7s;
}

.polaroid img { 
  width: 100%; 
  height: 140px; 
  object-fit: cover; 
  border: 1px solid #eee; 
}

.polaroid-caption { 
  font-size: 1rem; 
  color: #444; 
  text-align: center; 
  margin-top: 8px; 
}

.open .polaroid { 
  transform: translate(-145%, -65%) rotate(-12deg); 
  opacity: 1; 
}

/* --- THE LETTER (FIXED FOR VISIBILITY) --- */
.letter {
  position: absolute; 
  left: 50%; 
  top: 50%; 
  width: 90%; 
  height: auto; 
  min-height: 100%;
  transform: translate(-50%, -50%); 
  background-color: #fff9e6;
  padding: 20px 15px; 
  z-index: 20; /* High z-index to stay on top of all envelope flaps */
  transition: top 0.5s ease-in-out;
  display: flex; 
  flex-direction: column; 
  justify-content: center; 
  align-items: center;
  box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
}

.words { 
  text-align: center; 
  font-size: 1.4rem; 
  color: #ff1744; 
  line-height: 1.6rem; 
  margin-bottom: 8px; 
}

/* --- BUTTONS --- */
.decision-buttons { 
  display: flex; 
  gap: 15px; 
  justify-content: center; 
  margin-top: 15px; 
  width: 100%; 
  position: relative;
  z-index: 25;
}

#yes-btn, #no-btn { 
  padding: 8px 20px; 
  font-family: 'Engagement', cursive; 
  font-size: 1.2rem; 
  border: none; 
  border-radius: 10px; 
  cursor: pointer; 
  transition: transform 0.2s ease; 
}

#yes-btn { 
  background: #ff1744; 
  color: white; 
  animation: pulse 1.5s infinite; 
}

#no-btn { 
  background: #eeeeee; 
  color: #888; 
  position: relative; 
}

@keyframes pulse {
  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 23, 68, 0.7); }
  70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(255, 23, 68, 0); }
  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 23, 68, 0); }
}

/* --- ENVELOPE MECHANICS --- */
.container { 
  position: relative; 
  z-index: 10; 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
}

.envelope-wrapper { 
  position: relative; 
  width: 300px; 
  height: 200px; 
}

#envelope { 
  position: relative; 
  width: 100%; 
  height: 100%; 
  background: #ff2d55; 
  box-shadow: 0 0 40px rgba(0,0,0,0.6); 
  cursor: pointer; 
  z-index: 1; 
}

.side { 
  position: absolute; 
  width: 100%; 
  height: 100%; 
  background: #ff5e78; 
  z-index: 3; 
}

.side.left { clip-path: polygon(0 0, 0 100%, 50% 50%); }
.side.right { clip-path: polygon(100% 0, 100% 100%, 50% 50%); }

.pocket { 
  position: absolute; 
  width: 100%; 
  height: 100%; 
  background: #ff9eb0; 
  clip-path: polygon(0 100%, 100% 100%, 50% 50%); 
  z-index: 4; 
}

.flap { 
  position: absolute; 
  width: 100%; 
  height: 100%; 
  background: #ff3d5c; 
  clip-path: polygon(0 0, 100% 0, 50% 50%); 
  z-index: 5; 
  transform-origin: top; 
  transition: transform 0.4s ease-in-out, z-index 0.4s; 
}

/* --- OPEN STATES --- */
.open .flap { 
  transform: rotateX(180deg); 
  z-index: 1; 
}

.open .letter { 
  top: -10%; /* Lifts the letter well above the envelope front */
  transition-delay: 0.5s; 
}

.close .letter { 
  top: 50%; 
  transition-delay: 0s; 
}

.close .flap { 
  transform: rotateX(0deg); 
  z-index: 5; 
  transition-delay: 0.5s; 
}

/* --- EXTERNAL BUTTON --- */
#action-btn { 
  background: linear-gradient(45deg, #ff1744, #ff5e78); 
  color: white; 
  border: none; 
  padding: 15px 40px; 
  font-size: 1.2rem; 
  border-radius: 50px; 
  cursor: pointer; 
  margin-top: 30px; 
}

/* --- DESKTOP ADJUSTMENTS --- */
@media (min-width: 768px) {
  .envelope-wrapper { width: 450px; height: 300px; }
  .polaroid { width: 220px; height: 280px; }
  .words { font-size: 2.5rem; line-height: 2.8rem; }
  .open .letter { top: -5%; } /* Desktop can be slightly lower */
}
